"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[616],{5236:(O,g,s)=>{s.r(g),s.d(g,{default:()=>ee});var e=s(4496),b=s(7408);const _={paginate:b.i,sort:{active:"id",direction:"asc"},users:[]};var k=s(3992),C=s(1568),c=s(1560),f=s(2156),u=s(440),T=s(1528),m=s(2864),U=s(4060),l=s(6504),R=s(6056),I=s(8416),p=s(7816),D=s(3808),S=s(7760),y=s(8812),h=s(6716),M=s(7048);let E=(()=>{class r{constructor(t){this._httpClient=t}dataTableUser({length:t,pageIndex:a,pageSize:o},{active:i,direction:d}){return this._httpClient.post(`${h.O.apiUrl}/user/data-table`,{length:t,pageIndex:a,pageSize:o,active:i,direction:d})}userRequeriments(){return this._httpClient.get(`${h.O.apiUrl}/user/requeriment`)}userStore(t){return this._httpClient.post(`${h.O.apiUrl}/user`,t)}userUpdate(t){return this._httpClient.put(`${h.O.apiUrl}/user/${t.id}`,t)}userEdit(t){return this._httpClient.get(`${h.O.apiUrl}/user/${t}`)}userDelete(t){return this._httpClient.delete(`${h.O.apiUrl}/user/${t}`)}static#e=this.\u0275fac=function(a){return new(a||r)(e.CoB(M.KK))};static#t=this.\u0275prov=e.wxM({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var F=s(3576);function N(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Nombre requerido"),e.C$Y())}function q(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Celular requerido"),e.C$Y())}function A(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Email requerido"),e.C$Y())}function z(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Debe se un email"),e.C$Y())}function L(r,n){if(1&r&&(e.I0R(0,"mat-option",14),e.OEk(1),e.C$Y()),2&r){const t=n.$implicit;e.E7m("value",t.rol_id),e.yG2(),e.cNF(t.name)}}function Q(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Roles es requerido"),e.C$Y())}function j(r,n){if(1&r&&(e.I0R(0,"mat-option",14),e.OEk(1),e.C$Y()),2&r){const t=n.$implicit;e.E7m("value",t.building_id),e.yG2(),e.cNF(t.name)}}function B(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Edificio es requerido"),e.C$Y())}function P(r,n){if(1&r&&(e.I0R(0,"div",7)(1,"mat-form-field",8)(2,"mat-label"),e.OEk(3,"Seleccione edificio"),e.C$Y(),e.I0R(4,"mat-select",10),e.c53(5,j,2,2,"mat-option",14,e.wJt),e.C$Y(),e.yuY(7,B,2,0,"mat-error"),e.C$Y()(),e.I0R(8,"div",15),e.wR5(9,"hr",16),e.C$Y()),2&r){const t=e.GaO();let a;e.yG2(),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("multiple",!0)("placeholder","buildings")("formControlName","buildings"),e.yG2(),e.oho(t.buildings()),e.yG2(2),e.C0Y(7,null!=(a=t.formUser.get("buildings"))&&a.hasError("required")?7:-1)}}function J(r,n){if(1&r){const t=e.KQA();e.I0R(0,"div",7)(1,"label",17),e.OEk(2,"Resetear contrase\xf1a"),e.C$Y(),e.wR5(3,"br",18),e.I0R(4,"div",19)(5,"mat-slide-toggle",20),e.qCj("change",function(){e.usT(t);const o=e.GaO();return e.CGJ(o.handlerChangeResetPassword())}),e.OEk(6," Resetear contrase\xf1a "),e.C$Y()()()}2&r&&(e.yG2(5),e.E7m("formControlName","reset_password"))}function K(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Contrase\xf1a es requerido"),e.C$Y())}function V(r,n){if(1&r&&(e.I0R(0,"div",7)(1,"mat-form-field",8)(2,"mat-label"),e.OEk(3,"Contrase\xf1a"),e.C$Y(),e.wR5(4,"input",9),e.yuY(5,K,2,0,"mat-error"),e.C$Y()()),2&r){const t=e.GaO();let a;e.yG2(),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("placeholder","Contrase\xf1a")("formControlName","password"),e.yG2(),e.C0Y(5,null!=(a=t.formUser.get("password"))&&a.hasError("required")?5:-1)}}let W=(()=>{class r{constructor(t,a,o,i){this.data=t,this._matDialogRef=a,this._userService=o,this._snackBar=i,this.roles=(0,e.OCB)([]),this.buildings=(0,e.OCB)([]),this.formUser=new l.WC({id:new l.Ku(-1),name:new l.Ku("",[l.AQ.required]),email:new l.Ku("",[l.AQ.required,l.AQ.email]),roles:new l.Ku([1],[l.AQ.required]),celular:new l.Ku("",[l.AQ.required]),reset_password:new l.Ku(!1),password:new l.Ku("",[l.AQ.required]),buildings:new l.Ku([],[l.AQ.required])}),t.edit||this.formUser.get("reset_password").setValue(!0),this.requirement(),this.handlerChangeResetPassword()}handlerSubmit(){this.formUser.valid?this.data.edit?this.updateUser():this.storeUser():this.formUser.markAllAsTouched()}requirement(){var t=this;return(0,T.c)(function*(){const a=yield(0,D.o)(t._userService.userRequeriments());t.roles.set(a.data.roles),t.buildings.set(a.data.buildings),t.data.edit&&t.editUser()})()}storeUser(){this._userService.userStore(this.formUser.value).subscribe(a=>{200===a.meta.code&&(this._snackBar.openSnackBar(a.meta.message),this._matDialogRef.close(this.data))})}updateUser(){this._userService.userUpdate(this.formUser.value).subscribe(a=>{200===a.meta.code&&(this._snackBar.openSnackBar(a.meta.message),this._matDialogRef.close(this.data))})}editUser(){this._userService.userEdit(this.data.user_id).subscribe(t=>{200===t.meta.code&&this.formUser.setValue(t.data)})}handlerChangeResetPassword(){!0===this.formUser.get("reset_password").value?(this.formUser.get("password").setValue(""),this.formUser.get("password").setValidators(l.AQ.required),this.formUser.get("password").updateValueAndValidity()):(this.formUser.get("password").setValidators(null),this.formUser.get("password").updateValueAndValidity())}checkRol(){return this.formUser.get("roles").value.filter(o=>2===o).length>0}static#e=this.\u0275fac=function(a){return new(a||r)(e.GI1(m.sR),e.GI1(m.yI),e.GI1(E),e.GI1(y.u))};static#t=this.\u0275cmp=e.In1({type:r,selectors:[["app-modal-user"]],standalone:!0,features:[e.M5G([y.u]),e.UHJ],decls:41,vars:23,consts:[["mat-dialog-title","",1,"dialog-title","flex","justify-between"],[1,"text-2xl","w-full","mt-2","m-0","font-medium"],["mat-icon-button","","aria-label","close dialog","mat-dialog-close",""],["svgIcon","heroicons_outline:x-mark"],[3,"formGroup"],[1,"mat-typography"],[1,"grid","sm:grid-cols-1","md:grid-cols-4","lg:grid-cols-4","xl:grid-cols-4","gap-2"],[1,"col-span-2"],[1,"w-full",3,"floatLabel"],["matInput","",3,"placeholder","formControlName"],[3,"multiple","placeholder","formControlName"],["class","col-span-2"],[1,"flex","justify-end"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click"],[3,"value"],[1,"col-span-4"],[1,"m-0"],[1,"text-neutral-900"],[1,""],[1,"py-2"],[1,"example-margin",3,"formControlName","change"]],template:function(a,o){if(1&a&&(e.I0R(0,"div",0)(1,"div",1),e.OEk(2),e.C$Y(),e.I0R(3,"button",2),e.wR5(4,"mat-icon",3),e.C$Y()(),e.I0R(5,"form",4)(6,"mat-dialog-content",5)(7,"div",6)(8,"div",7)(9,"mat-form-field",8)(10,"mat-label"),e.OEk(11,"Nombre completo"),e.C$Y(),e.wR5(12,"input",9),e.yuY(13,N,2,0,"mat-error"),e.C$Y()(),e.I0R(14,"div",7)(15,"mat-form-field",8)(16,"mat-label"),e.OEk(17,"Celular"),e.C$Y(),e.wR5(18,"input",9),e.yuY(19,q,2,0,"mat-error"),e.C$Y()(),e.I0R(20,"div",7)(21,"mat-form-field",8)(22,"mat-label"),e.OEk(23,"Email"),e.C$Y(),e.wR5(24,"input",9),e.yuY(25,A,2,0,"mat-error")(26,z,2,0,"mat-error"),e.C$Y()(),e.I0R(27,"div",7)(28,"mat-form-field",8)(29,"mat-label"),e.OEk(30,"Roles"),e.C$Y(),e.I0R(31,"mat-select",10),e.c53(32,L,2,2,"mat-option",14,e.wJt),e.C$Y(),e.yuY(34,Q,2,0,"mat-error"),e.C$Y()(),e.yuY(35,P,10,5)(36,J,7,1,"div",11)(37,V,6,4,"div",11),e.C$Y()(),e.I0R(38,"mat-dialog-actions",12)(39,"button",13),e.qCj("click",function(){return o.handlerSubmit()}),e.OEk(40," Guardar "),e.C$Y()()()),2&a){let i,d,G,$,w;e.yG2(2),e.cNF(o.data.name),e.yG2(3),e.E7m("formGroup",o.formUser),e.yG2(4),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("placeholder","Nombre completo")("formControlName","name"),e.yG2(),e.C0Y(13,null!=(i=o.formUser.get("name"))&&i.hasError("required")?13:-1),e.yG2(2),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("placeholder","Celular")("formControlName","celular"),e.yG2(),e.C0Y(19,null!=(d=o.formUser.get("celular"))&&d.hasError("required")?19:-1),e.yG2(2),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("placeholder","Email")("formControlName","email"),e.yG2(),e.C0Y(25,null!=(G=o.formUser.get("email"))&&G.hasError("required")?25:-1),e.yG2(),e.C0Y(26,null!=($=o.formUser.get("email"))&&$.hasError("email")?26:-1),e.yG2(2),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("multiple",!0)("placeholder","roles")("formControlName","roles"),e.yG2(),e.oho(o.roles()),e.yG2(2),e.C0Y(34,null!=(w=o.formUser.get("roles"))&&w.hasError("required")?34:-1),e.yG2(),e.C0Y(35,o.checkRol()?35:-1),e.yG2(),e.C0Y(36,o.data.edit?36:-1),e.yG2(),e.C0Y(37,!0===o.formUser.get("reset_password").value?37:-1)}},dependencies:[c.oB,c.qL,m.WQ,m.iU,m.Yp,m.qq,m.sr,U.wb,U.Up,U.w5,U.wJ,R.d5,R.kX,F.I5,l.y,l.sz,l.ot,l.ue,l.u,I.cN,I.yi,l.sl,l.uW,l.Wo,p.oJ,p.Gw,p.um,S.cP],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return r})();var x=s(1725),Y=s(1292);function H(r,n){if(1&r&&(e.I0R(0,"mat-chip",21),e.OEk(1),e.C$Y()),2&r){const t=n.$implicit;e.yG2(),e.cNF(t)}}function X(r,n){if(1&r){const t=e.KQA();e.I0R(0,"div",12)(1,"div",13),e.OEk(2),e.C$Y(),e.I0R(3,"div",14),e.OEk(4),e.C$Y(),e.I0R(5,"div",14),e.OEk(6),e.C$Y(),e.I0R(7,"div",15),e.c53(8,H,2,1,"mat-chip",22,e.wJt),e.C$Y(),e.I0R(10,"div",16)(11,"button",17),e.qCj("click",function(){const i=e.usT(t).$implicit,d=e.GaO();return e.CGJ(d.handlerOpenModalUser({edit:!0,user_id:i.id,name:"Editar User"}))}),e.wR5(12,"mat-icon",18),e.C$Y(),e.I0R(13,"button",19),e.qCj("click",function(){const i=e.usT(t).$implicit,d=e.GaO();return e.CGJ(d.handlerOpenDeleteUser(i.id))}),e.wR5(14,"mat-icon",20),e.C$Y()()()}if(2&r){const t=n.$implicit,a=e.GaO();e.yG2(2),e.oRS(" ",t.name," "),e.yG2(2),e.oRS(" ",t.email," "),e.yG2(2),e.oRS(" ",t.celular," "),e.yG2(2),e.oho(a.rolesToArray(t.roles)),e.yG2(5),e.E7m("color","warn")}}let Z=(()=>{class r{constructor(t,a,o,i){this._matDialog=t,this._confirmation=a,this._userService=o,this._snackBar=i,this.initialPagination=b.i,this.dataTableUser=e.YhN.required(),this.reloadDataTableUser=new e._w7}handleSorts(){this.dataTableUser().sort.active=this._sort.active,this.dataTableUser().sort.direction=this._sort.direction,this.reloadDataTableUser.emit(this.dataTableUser())}handlePageEvent(t){this.dataTableUser().paginate.length=t.length,this.dataTableUser().paginate.pageIndex=t.pageIndex,this.dataTableUser().paginate.pageSize=t.pageSize,this.reloadDataTableUser.emit(this.dataTableUser())}handlerOpenModalUser(t){this._matDialog.open(W,{width:"800px",data:t}).afterClosed().subscribe(a=>{void 0!==a&&this.reloadDataTableUser.emit(this.dataTableUser())})}rolesToArray(t){return t.split(",")}handlerOpenDeleteUser(t){console.log("handlerDeleteUser",t),this._confirmation.confirmation({title:"Eliminar",message:"Esta seguro de eliminar este usuario?",icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"success"},actions:{confirm:{show:!0,label:"Si",color:"warn"},cancel:{show:!0,label:"Cancelar"}},dismissible:!0}).afterClosed().subscribe(a=>{"confirmed"==a&&this.handlerDeleteUser(t)})}handlerDeleteUser(t){this._userService.userDelete(t).subscribe(a=>{200===a.meta.code&&(this._snackBar.openSnackBar(a.meta.message),this.reloadDataTableUser.emit(this.dataTableUser()))})}static#e=this.\u0275fac=function(a){return new(a||r)(e.GI1(m.qW),e.GI1(Y.Q),e.GI1(E),e.GI1(y.u))};static#t=this.\u0275cmp=e.In1({type:r,selectors:[["data-table-user"]],viewQuery:function(a,o){if(1&a&&(e.CC$(f.Qb,5),e.CC$(u.E9,5)),2&a){let i;e.wto(i=e.Gqi())&&(o._paginator=i.first),e.wto(i=e.Gqi())&&(o._sort=i.first)}},inputs:{dataTableUser:[e.Wk5.SignalBased,"dataTableUser"]},outputs:{reloadDataTableUser:"reloadDataTableUser"},standalone:!0,features:[e.M5G([Y.Q,y.u]),e.UHJ],decls:21,vars:11,consts:[[1,"flex","justify-end","px-4","py-2","bg-card"],["mat-flat-button","","type","button",1,"",3,"color","disabled","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],[1,"grid","border"],["matSort","","matSortDisableClear","",1,"movement-grid","grid","xs:grid-cols-2","sm:grid-cols-3","md:grid-cols-5","lg:grid-cols-5","xl:grid-cols-5","z-10","sticky","top-0","gap-2","py-4","px-6","md:px-8","shadow","font-semibold","text-secondary","bg-gray-50","dark:dark:bg-neutral-900","dark:bg-opacity-5"],[1,"truncate","xs:truncate","sm:truncate","md:block","lg:block","xl:block",3,"mat-sort-header","click"],[1,"hidden","xs:hidden","sm:block","md:block","lg:block","xl:block",3,"mat-sort-header","click"],[1,"hidden","xs:hidden","sm:hidden","md:hidden","lg:block","xl:block",3,"mat-sort-header","click"],[1,"truncate","xs:truncate","sm:truncate","md:block","lg:block","xl:block"],[1,"flex","flex-auto","flex-col","overflow-y-auto"],[1,"bg-gray-50","border-b","dark:bg-transparent","absolute","border-t","bottom-0","inset-x-0","z-10",3,"length","pageIndex","pageSize","pageSizeOptions","page"],[1,"movement-grid","grid","xs:grid-cols-2","sm:grid-cols-3","md:grid-cols-5","lg:grid-cols-5","xl:grid-cols-5","items-center","gap-2","py-3","px-6","md:px-8","border-b"],[1,"truncate","xs:truncate","sm:block","md:block","lg:block","xl:block"],[1,"hidden","xs:truncate","sm:block","md:block","lg:block","xl:block"],[1,"hidden","xs:hidden","sm:hidden","md:block","lg:block","xl:block"],[1,"truncate","xs:truncate","md:block","lg:block","xl:block"],["mat-icon-button","",3,"click"],["svgIcon","heroicons_solid:arrow-top-right-on-square"],["mat-icon-button","","matTooltip","Eliminar",1,"mx-1",3,"color","click"],["svgIcon","heroicons_outline:trash"],["cdkDrag","",1,"mx-1"],["class","mx-1","cdkDrag",""],["class","movement-grid grid xs:grid-cols-2 sm:grid-cols-3 md:grid-cols-5 lg:grid-cols-5 xl:grid-cols-5 items-center gap-2 py-3 px-6 md:px-8 border-b"]],template:function(a,o){1&a&&(e.I0R(0,"div",0)(1,"button",1),e.qCj("click",function(){return o.handlerOpenModalUser({edit:!1,user_id:-1,name:"Nuevo User"})}),e.wR5(2,"mat-icon",2),e.I0R(3,"span",3),e.OEk(4,"Nuevo Usuario"),e.C$Y()()(),e.I0R(5,"div",4)(6,"div",5)(7,"div",6),e.qCj("click",function(){return o.handleSorts()}),e.OEk(8," Nombre "),e.C$Y(),e.I0R(9,"div",7),e.qCj("click",function(){return o.handleSorts()}),e.OEk(10," Email "),e.C$Y(),e.I0R(11,"div",7),e.qCj("click",function(){return o.handleSorts()}),e.OEk(12," Celular "),e.C$Y(),e.I0R(13,"div",8),e.qCj("click",function(){return o.handleSorts()}),e.OEk(14," Roles "),e.C$Y(),e.I0R(15,"div",9),e.OEk(16," Acciones "),e.C$Y()(),e.I0R(17,"div",10),e.c53(18,X,15,4,"div",23,e.wJt),e.I0R(20,"mat-paginator",11),e.qCj("page",function(d){return o.handlePageEvent(d)}),e.C$Y()()()),2&a&&(e.yG2(),e.E7m("color","primary")("disabled",!1),e.yG2(),e.E7m("svgIcon","heroicons_outline:plus"),e.yG2(5),e.E7m("mat-sort-header","name"),e.yG2(2),e.E7m("mat-sort-header","email"),e.yG2(2),e.E7m("mat-sort-header","celular"),e.yG2(2),e.E7m("mat-sort-header","roles"),e.yG2(5),e.oho(o.dataTableUser().users),e.yG2(2),e.E7m("length",o.dataTableUser().paginate.length)("pageIndex",o.dataTableUser().paginate.pageIndex)("pageSize",o.dataTableUser().paginate.pageSize)("pageSizeOptions",o.initialPagination.PageSizeOption))},dependencies:[u.Su,u.E9,u.e6,c.qL,f.Qb,x.Gs,x.oH,p.oJ,p.Gw,p.um],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return r})();const ee=[{path:"",component:(()=>{class r{constructor(t){this._userService=t,this.dataTableUser=(0,e.OCB)(_)}ngOnInit(){this.inizializeDataTable()}inizializeDataTable(){this._userService.dataTableUser(this.dataTableUser().paginate,this.dataTableUser().sort).pipe((0,k.U)(1)).subscribe(t=>{this.dataTableUser.set(t.data)})}handlerLoadDataTableUser(t){this.dataTableUser.set(t),this.inizializeDataTable()}static#e=this.\u0275fac=function(a){return new(a||r)(e.GI1(E))};static#t=this.\u0275cmp=e.In1({type:r,selectors:[["list-user"]],standalone:!0,features:[e.UHJ],decls:14,vars:3,consts:[[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","sm:justify-between","p-6","sm:py-12","md:px-8","border-b","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500",3,"routerLink"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-slate-900"],[1,"mt-2"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[3,"dataTableUser","reloadDataTableUser"]],template:function(a,o){1&a&&(e.I0R(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"a",3),e.OEk(5,"Tablero"),e.C$Y()(),e.I0R(6,"div",4),e.wR5(7,"mat-icon",5),e.I0R(8,"a",6),e.OEk(9,"Usuarios y roles"),e.C$Y()()(),e.I0R(10,"div",7)(11,"h2",8),e.OEk(12," Usuarios y roles "),e.C$Y()()()(),e.I0R(13,"data-table-user",9),e.qCj("reloadDataTableUser",function(d){return o.handlerLoadDataTableUser(d)}),e.C$Y()),2&a&&(e.yG2(4),e.E7m("routerLink","/building"),e.yG2(3),e.E7m("svgIcon","heroicons_mini:chevron-right"),e.yG2(6),e.E7m("dataTableUser",o.dataTableUser()))},dependencies:[C.ER,c.qL,Z],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return r})()}]},3808:(O,g,s)=>{s.d(g,{o:()=>b});var e=s(7696);function b(_,v){const k="object"==typeof v;return new Promise((C,c)=>{let u,f=!1;_.subscribe({next:T=>{u=T,f=!0},error:c,complete:()=>{f?C(u):k?C(v.defaultValue):c(new e.G)}})})}}}]);